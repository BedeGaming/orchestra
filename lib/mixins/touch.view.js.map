{"version":3,"sources":["mixins/touch.view.js"],"names":[],"mappings":";;;AAGA;;;;;;AAEA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,IAAM,wBAAwB,gBAAxB;;kBAES;;AAEb,gBAAc,EAAd;;AAEA,oBAAkB,EAAlB;;AAEA,gDAAmB;AACjB,SAAK,uBAAL,GADiB;GANN;AAUb,8DAA0B;AACxB,SAAK,SAAL,GADwB;GAVb;AAcb,4CAAiB;AACf,SAAK,qBAAL,GADe;AAEf,WAAO,IAAP,CAFe;GAdJ;AAmBb,wDAAsB,QAAQ;;;AAC5B,QAAM,UAAU,iBAAE,QAAF,CAAW,KAAK,aAAL,IAAsB,EAAtB,EAA0B,mBAAS,aAAT,CAA/C,CADsB;;AAG5B,QAAI,EAAE,WAAW,SAAS,iBAAE,MAAF,CAAS,IAAT,EAAe,cAAf,CAAT,CAAX,CAAF,EAAwD;AAC1D,aAAO,IAAP,CAD0D;KAA5D;;AAIA,qBAAE,IAAF,CAAO,MAAP,EAAe,UAAC,SAAD,EAAY,GAAZ,EAAoB;AACjC,UAAI,SAAS,SAAT,CAD6B;;AAGjC,UAAI,CAAC,iBAAE,UAAF,CAAa,MAAb,CAAD,EAAuB;AACzB,iBAAS,MAAK,SAAL,CAAT,CADyB;OAA3B;;AAIA,UAAI,MAAJ,EAAY;AACV,YAAM,QAAQ,IAAI,KAAJ,CAAU,qBAAV,CAAR,CADI;AAEV,YAAM,WAAW,MAAM,CAAN,CAAX,CAFI;AAGV,YAAI,YAAY,MAAM,CAAN,CAAZ,CAHM;;AAKV,iBAAS,iBAAE,IAAF,CAAO,MAAP,QAAT,CALU;AAMV,cAAK,OAAL,CAAa,OAAb,EAAsB,QAAtB,EAAgC,SAAhC,EAA2C,MAA3C,EANU;OAAZ;KAPa,CAAf,CAP4B;;AAyB5B,WAAO,IAAP,CAzB4B;GAnBjB;AA+Cb,8CAAiB,UAAU,QAAQ;;;AACjC,WAAO,UAAC,CAAD,EAAO;AACZ,UAAI,UAAU,OAAK,GAAL,CADF;;AAGZ,UAAI,QAAJ,EAAc;AACZ,kBAAU,QAAQ,IAAR,CAAa,QAAb,CAAV,CADY;OAAd;;AAIA,cAAQ,IAAR,CAAa,UAAC,CAAD,EAAI,EAAJ,EAAW;AACtB,YAAI,MAAM,sBAAE,EAAF,CAAN,CADkB;;AAGtB,YAAI,OAAO,EAAE,MAAF,IAAY,IAAI,GAAJ,CAAQ,EAAE,MAAF,CAAR,CAAkB,MAAlB,EAA0B;AAC/C,cAAI,QAAQ,iBAAE,MAAF,CAAS,CAAT,EAAY,EAAC,eAAe,EAAf,EAAb,CAAR,CAD2C;AAE/C,iBAAO,KAAP,EAF+C;SAAjD;OAHW,CAAb,CAPY;KAAP,CAD0B;GA/CtB;AAkEb,4BAAQ,SAAS,UAAU,WAAW,QAAQ;AAC5C,QAAI,CAAC,KAAK,GAAL,IAAY,CAAC,KAAK,GAAL,CAAS,MAAT,EAAiB,OAAO,KAAP,CAAnC;;AAEA,QAAI,SAAS,uBAAW,KAAK,GAAL,CAAS,GAAT,CAAa,CAAb,CAAX,EAA4B,iBAAE,KAAF,CAAQ,OAAR,CAA5B,CAAT,CAHwC;AAI5C,QAAI,UAAU,KAAK,gBAAL,CAAsB,QAAtB,EAAgC,MAAhC,CAAV,CAJwC;;AAM5C,WAAO,EAAP,CAAU,SAAV,EAAqB,OAArB,EAN4C;AAO5C,SAAK,gBAAL,CAAsB,IAAtB,CAA2B,MAA3B,EAP4C;GAlEjC;AA4Eb,kCAAY;AACV,qBAAE,IAAF,CAAO,KAAK,gBAAL,EAAuB,UAAC,CAAD;aAAO,EAAE,OAAF;KAAP,CAA9B,CADU;AAEV,SAAK,gBAAL,GAAwB,EAAxB,CAFU;GA5EC","file":"mixins/touch.view.js","sourcesContent":["//\n// #orchestra/mixins/touch.view.js\n//\n'use strict';\n\nimport Backbone from 'backbone';\nimport Hammer from 'hammerjs';\nimport _ from 'lodash';\nimport $ from 'jquery';\n\nconst delegateEventSplitter = /^(\\S+)\\s*(.*)$/;\n\nexport default {\n\n  hammerEvents: {},\n\n  _hammerInstances: [],\n\n  undelegateEvents() {\n    this._undelegateHammerEvents();\n  },\n\n  _undelegateHammerEvents() {\n    this._unhammer();\n  },\n\n  delegateEvents() {\n    this._delegateHammerEvents();\n    return this;\n  },\n\n  _delegateHammerEvents(events) {\n    const options = _.defaults(this.hammerOptions || {}, Backbone.hammerOptions);\n\n    if (!(events || (events = _.result(this, 'hammerEvents')))) {\n      return this;\n    }\n\n    _.each(events, (eventItem, key) => {\n      let method = eventItem;\n\n      if (!_.isFunction(method)) {\n        method = this[eventItem];\n      }\n\n      if (method) {\n        const match = key.match(delegateEventSplitter);\n        const selector = match[2];\n        let eventName = match[1];\n\n        method = _.bind(method, this);\n        this._hammer(options, selector, eventName, method);\n      }\n\n    });\n\n    return this;\n  },\n\n  _getEventHandler(selector, method) {\n    return (e) => {\n      let context = this.$el;\n\n      if (selector) {\n        context = context.find(selector);\n      }\n\n      context.each((i, el) => {\n        let $el = $(el);\n\n        if (el === e.target || $el.has(e.target).length) {\n          let event = _.extend(e, {currentTarget: el});\n          method(event);\n        }\n      });\n    };\n  },\n\n  _hammer(options, selector, eventName, method) {\n    if (!this.$el || !this.$el.length) return false;\n\n    let hammer = new Hammer(this.$el.get(0), _.clone(options));\n    let handler = this._getEventHandler(selector, method);\n\n    hammer.on(eventName, handler);\n    this._hammerInstances.push(hammer);\n  },\n\n  _unhammer() {\n    _.each(this._hammerInstances, (i) => i.destroy());\n    this._hammerInstances = [];\n  }\n};\n"],"sourceRoot":"/source/"}