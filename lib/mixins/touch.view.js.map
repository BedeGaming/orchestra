{"version":3,"sources":["mixins/touch.view.js"],"names":[],"mappings":"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","file":"mixins/touch.view.js","sourcesContent":["//\n// #orchestra/mixins/touch.view.js\n//\n'use strict';\n\nimport Backbone from 'backbone';\nimport Hammer from 'hammerjs';\nimport _ from 'lodash';\nimport $ from 'jquery';\n\nconst delegateEventSplitter = /^(\\S+)\\s*(.*)$/;\n\nexport default {\n\n  hammerEvents: {},\n\n  _hammerInstances: [],\n\n  undelegateEvents() {\n    this._undelegateHammerEvents();\n  },\n\n  _undelegateHammerEvents() {\n    this._unhammer();\n  },\n\n  delegateEvents() {\n    this._delegateHammerEvents();\n    return this;\n  },\n\n  _delegateHammerEvents(events) {\n    const options = _.defaults(this.hammerOptions || {}, Backbone.hammerOptions);\n\n    if (!(events || (events = _.result(this, 'hammerEvents')))) {\n      return this;\n    }\n\n    _.each(events, (eventItem, key) => {\n      let method = eventItem;\n\n      if (!_.isFunction(method)) {\n        method = this[eventItem];\n      }\n\n      if (method) {\n        const match = key.match(delegateEventSplitter);\n        const selector = match[2];\n        let eventName = match[1];\n\n        method = _.bind(method, this);\n        this._hammer(options, selector, eventName, method);\n      }\n\n    });\n\n    return this;\n  },\n\n  _getEventHandler(selector, method) {\n    return (e) => {\n      let context = this.$el;\n\n      if (selector) {\n        context = context.find(selector);\n      }\n\n      context.each((i, el) => {\n        let $el = $(el);\n\n        if (el === e.target || $el.has(e.target).length) {\n          let event = _.extend(e, {currentTarget: el});\n          method(event);\n        }\n      });\n    };\n  },\n\n  _hammer(options, selector, eventName, method) {\n    if (!this.$el || !this.$el.length) return false;\n\n    let hammer = new Hammer(this.$el.get(0), _.clone(options));\n    let handler = this._getEventHandler(selector, method);\n\n    hammer.on(eventName, handler);\n    this._hammerInstances.push(hammer);\n  },\n\n  _unhammer() {\n    _.each(this._hammerInstances, (i) => i.destroy());\n    this._hammerInstances = [];\n  }\n};\n"],"sourceRoot":"/source/"}